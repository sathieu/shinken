$seekfilesdir = '/usr/local/shinken/var/tmp';
# where the state information will be saved.

$protocolsdir = '/usr/local/shinken/var/tmp';
# where protocols with found patterns will be stored.

$scriptpath = '/usr/local/shinken/var/tmp';
# where scripts will be searched for.

$MACROS = {};

@searches = (
{
  tag => 'tape',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  warningpatterns => [
    'TAPE_ERR1',
    'TAPE_ERR2',
    'TAPE_ERR3',
    'TAPE_ERR4',
    'TAPE_ERR5',
    'TAPE_ERR6',
    'SC_TAPE_ERR1',
    'SC_TAPE_ERR2',
    'SC_TAPE_ERR3',
    'SC_TAPE_ERR4',
    'SC_TAPE_ERR5',
    'SC_TAPE_ERR6',
    'SC_TAPE_ERR7',
    'SC_TAPE_ERR8',
  ],
},
{
  tag => 'Cache battery',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATION',
  warningpatterns => [
    'FCP_ARRAY_ERR15',
    'DISK_ARRAY_ERR15',
  ],
},
{
  tag => 'Loss redundancy power supply',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  warningpatterns =>  'EPOW_SUS',
},
{
  tag => 'Microcode program error',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  warningpatterns => [
    'SCSI_ERR4',
    'CAT_ERR2',
    'SCSI_ERR3',
    'MID_UCODE',
    'FCS_ERR6',
    'FCS_ERR5',
  ],
},
{
  tag => 'Stale partition',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  warningpatterns => 'LVM_SA_STALEPP',
},
{
  tag => 'Adapter errors',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'SCSI_ERR1',
    'USB_ADAPTER_ERROR',
    'FCA_ERR1',
    'FCA_ERR9',
    'FCP_ERR1',
    'FCP_ERR5',
    'FCP_ERR9',
    'FSCSI_ERR4',
    'CAT_ERR8',
    'MID_PIPE2',
    'MID_BLASTB',
    'MPQP_XFTO',
    'ECH_ADAP_FAIL',
    'FCS_ERR2',
    'MID_PIPE1',
    'MID_PIPE3',
    'FCP_ERR6',
    'FCS_ERR1',
    'GOENT_EEPROM_ERR',
    'MPQP_ADPERR',
    'SCSI_ERR2',
    'GOENT_ADAP_ERR',
    'MID_PIPE4',
    'CAT_ERR5',
    'FCS_ERR9',
    'FCA_ERR2',
    'FSCSI_ERR2',
    'FSCSI_ERR1',
    'FCP_ERR2',
    'MID_BLAST',
    'FSCSI_ERR3',
  ],
},
{
  tag => 'Array configuration changed',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'DISK_ARRAY_ERR10',
    'FCP_ARRAY_ERR10',
  ],
},
{
  tag => 'Array configuration errors',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'SISIOA_ERR06T',
    'SISIOA_ERR04T',
  ],
},
{
  tag => 'Array drive failure',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'FCP_ARRAY_ERR14',
    'DISK_ARRAY_ERR14',
  ],
},
{
  tag => 'Array operation error',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'DISK_ARRAY_ERR1',
    'DISK_ARRAY_ERR2',
    'DISK_ARRAY_ERR3',
    'DISK_ARRAY_ERR4',
    'FCP_ARRAY_ERR1',
    'FCP_ARRAY_ERR2',
    'FCP_ARRAY_ERR4',
    'FCP_ARRAY_ERR3',
  ],
},
{
  tag => 'Array controller switch failure',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'DISK_ARRAY_ERR9',
    'FCP_ARRAY_ERR9',
  ],
},
{
  tag => 'Cache battery charge under 87%',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'FCP_ARRAY_ERR16',
    'DISK_ARRAY_ERR16',
  ],
},
{
  tag => 'Controller health check failure',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [ 
    'DISK_ARRAY_ERR7',
    'FCP_ARRAY_ERR7',
  ],
},
{
  tag => 'Controller death',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'TS_DEATH_TR',
},
{
  tag => 'Cpu failure',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'CPU_FAIL_CAP_REDUCT',
    'CPU_FAIL_PREDICTED',
  ],
},
{
  tag => 'Device errors',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'USB_DEVICE_ERROR',
    'GRAPHICS_ADAPTER_ER',
    'FCA_ERR14',
    'SISIOA_ERR01P',
    'FCP_ERR14',
    'SISIOA_ERR01T',
    'FCP_ERR13',
    'TMSCSI_RECVRD_ERR',
    'HARDWARE_SYMPTOM',
    'TMSCSI_CMD_ERR',
    'TMSCSI_UNRECVRD_ERR',
    'ATAIDE_ERR3',
    'FCA_ERR13',
  ],
},
{
  tag => 'Disk operation failure',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'DISK_ERR1',
    'DISK_ERR2',
    'DISK_ERR3',
    'DISK_ERR4',
    'CMDLVM',
    'SC_DISK_ERR1',
    'SC_DISK_ERR2',
    'SC_DISK_ERR3',
    'SC_DISK_ERR4',
    'SC_DISK_ERR6',
  ],
},
{
  tag => 'Ethernet Down',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'GOENT_FAILOVER_FAIL',
    'GOENT_LINK_DOWN',
  ],
},
{
  tag => 'File System corruption',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'J2_BUFMGR_CORRUPT',
    'J2_SNAPSHOT_CORRUPT',
    'J2_IMFRLIST_CORRUPT',
    'J2_VCPAGER_CORRUPT',
    'J2_DTREE_CORRUPT',
    'J2_TXN_CORRUPT',
    'J2_METADATA_CORRUPT',
    'J2_IMAP_CORRUPT',
    'JFS_META_CORRUPTION',
    'J2_PAGER_CORRUPT',
    'J2_DMAP_CORRUPT',
    'J2_CORRUPTION',
    'J2_TXNLOCK_CORRUPT',
    'J2_LOG_CORRUPT',
    'J2_DIOBUF_CORRUPT',
    'J2_XTREE_CORRUPT',
    'JFS_META_WRITE_ERR',
    'J2_TXCMABRT_CORRUPT',
    'J2_DMAPI_CORRUPT',
  ],
},
{
  tag => 'I/O errors',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'SM4_LOCK_DOWN',
    'J2_METADATA_EIO',
    'J2_LOG_EIO',
    'LVM_IO_FAIL',
    'J2_USERDATA_EIO',
  ],
},
{
  tag => 'No paging space available',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'NO_PGSP',
},
{
  tag => 'PV declared Missing',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'LVM_SA_PVMISS',
},
{
  tag => 'PV defined as missing',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'LVM_MISSPVADDED',
},
{
  tag => 'SCSI Bus or Device errors',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'SISIOA_ERR01P',
    'SISIOA_ERR01T',
  ],
},
{
  tag => 'Storage Subsystem failure',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'JFS_LOG_EXCEPTION',
    'JFS_META_EXCEPTION',
  ],
},
{
  tag => 'Possible malfunction on local adapter',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => 'TS_LOC_DOWN_ST',
},
{
  tag => 'Unable to allocate space in Filesystem',
  logfile => '/var/log/rhosts/ibm5.log',
  rotation => 'LOGROTATE',
  criticalpatterns => [
    'JFS_FS_FULL',
    'JFS_FS_FRAGMENTED',
    'JFS_FS_NOINODES',
    'J2_FS_FULL',
  ],
});
